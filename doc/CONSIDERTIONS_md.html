<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>CONSIDERTIONS - RDoc Documentation</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "./";
  var index_rel_prefix = "./";
</script>

<script src="./js/navigation.js" defer></script>
<script src="./js/search.js" defer></script>
<script src="./js/search_index.js" defer></script>
<script src="./js/searcher.js" defer></script>
<script src="./js/darkfish.js" defer></script>

<link href="./css/fonts.css" rel="stylesheet">
<link href="./css/rdoc.css" rel="stylesheet">


<body id="top" role="document" class="file">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="./index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="./table_of_contents.html#pages">Pages</a>
    <a href="./table_of_contents.html#classes">Classes</a>
    <a href="./table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search (/) for a class, method, ..." spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  
<div class="nav-section">
  <h3>Table of Contents</h3>



  <ul class="link-list" role="directory">
              <li>
            <details open>
              <summary>      <a href="#label-Considerations-2C+Work+in+progress.">Considerations, Work in progress.</a>
</summary>
              <ul class="link-list" role="directory">
                          <li>      <a href="#label-Protection+of+data+that+belongs+to+a+data+owner">Protection of data that belongs to a data owner</a>
          <li>      <a href="#label-Composition+of+data+in+a+log+entry">Composition of data in a log entry</a>
          <li>      <a href="#label-example+of+how+a+Loggable-3A-3AActivity+is+formatted+for+the+view">example of how a <code>Loggable::Activity</code> is formatted for the view</a>

              </ul>
            </details>
          </li>

  </ul>
</div>


  <div id="project-metadata">
    
<div id="fileindex-section" class="nav-section">
  <h3>Pages</h3>

  <ul class="link-list">
    <li><a href="./CHANGELOG_md.html">CHANGELOG</a>
    <li><a href="./CODE_OF_CONDUCT_md.html">CODE_OF_CONDUCT</a>
    <li><a href="./CONSIDERTIONS_md.html">CONSIDERTIONS</a>
    <li><a href="./GETTING-STARTED_md.html">GETTING-STARTED</a>
    <li><a href="./Gemfile.html">Gemfile</a>
    <li><a href="./Gemfile_lock.html">Gemfile.lock</a>
    <li><a href="./LICENSE_txt.html">LICENSE</a>
    <li><a href="./README_md.html">README</a>
    <li><a href="./ROADMAP_md.html">ROADMAP</a>
    <li><a href="./Rakefile.html">Rakefile</a>
    <li><a href="./bin/setup.html">setup</a>
    <li><a href="./notes/CHEAT_SHEET_md.html">CHEAT_SHEET</a>
    <li><a href="./sig/loggable_activity_rbs.html">loggable_activity.rbs</a>
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-label="Page CONSIDERTIONS.md">

<h1 id="label-Considerations-2C+Work+in+progress.">Considerations, Work in progress.<span><a href="#label-Considerations-2C+Work+in+progress.">&para;</a> <a href="#top">&uarr;</a></span></h1>

<p>This document is stored here and might deleted&lt;br/&gt; &lt;br/&gt; It should be easy to configure and use the <em>LoggablActivity</em> without having to collect and format data all over the system.&lt;br/&gt; It should also be possible to delete a data owner and then all data related to that data owner should be inaccessible.</p>

<h3 id="label-Protection+of+data+that+belongs+to+a+data+owner">Protection of data that belongs to a data owner<span><a href="#label-Protection+of+data+that+belongs+to+a+data+owner">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>One way to protect data in a field is to encrypt it, when requested it can then be decrypted.&lt;br/&gt; If the data is required permanently deleted all there is to do is to throw away the key.&lt;br/&gt; Another way is to delete the content in all fields for a given data owner on request.&lt;br/&gt;</p>

<h3 id="label-Composition+of+data+in+a+log+entry">Composition of data in a log entry<span><a href="#label-Composition+of+data+in+a+log+entry">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>Lets consider an example with a user, the user has som personal information directly on the users DB Record. The user also has a relation to an address and the user might have a couple relations to other users, friends family members etc.&lt;br/&gt; All this is created from one form and when it is submitted we want to log it. One way of do it is to collect all the data from the DB and pack it into a json payload and submit it to the log, but then we have no control of&lt;br/&gt; What data is confidential and who it belongs to. So instead lets make some configurations for how data are handled. &lt;br/&gt;<em>Example</em></p>

<pre>┌──────────────────────┐      ┌──────────────────────┐
│         User         │  ┌──▶│       Address        │
├──────────────────────┤  │   ├──────────────────────┤
│name: String          │  │   │street: String        │
├──────────────────────┤  │   ├──────────────────────┤
│date_of_birth: Date   │  │   │city: String          │
├──────────────────────┤  │   └──────────────────────┘
│address_id: Reference │──┘                           
├──────────────────────┤                              
│system_task_uuid: UUID│                              
└──────────────────────┘                              
            ┼                                         
            │                                         
           ╱│╲                                        
┌──────────────────────┐                              
│       Friend         │                              
├──────────────────────┤                              
│user_a_id: Reference  │                              
├──────────────────────┤                              
│user_b_id: Reference  │                              
└──────────────────────┘</pre>

<p>Then a payload could look like this</p>

<pre>
{
  user: {
    name: Sting
    date_of_birth &quot;October 2, 1951&quot;
    address: {
      street: &quot;some street&quot;,
      city: &quot;London&quot;
    },
    friend: [
      user: {
        name: &quot;Bob&quot;
        date_of_birth: &quot;September 01, 1991
      }
    ]
  }
}</pre>

<p>But what about Bob, he is in the system and want to have control of his own data.&lt;br/&gt; To achieve this we need to organize the way we store log entries so owners can be identified even within a payload.</p>

<pre>┌────────────────────────┐
        │        Activity        │
        ├────────────────────────┤
        │key: String             │
        ├────────────────────────┤
        │who_did_it_type: String │
        ├────────────────────────┤
        │who_did_it_id: UUID     │
        ├────────────────────────┤
        │time: DateTime          │
        └────────────────────────┘
                    ┼            
                    │            
                    │            
                   ╱│╲           
        ┌────────────────────────┐
        │        Payload         │
        ├────────────────────────┤
        │data: Json              │
        ├────────────────────────┤
        │record_id: UUID         │
        ├────────────────────────┤
        │record_type: String     │
        └────────────────────────┘</pre>

<p>So now we can control access to Bobs data in the Logging DB</p>

<h3 id="label-example+of+how+a+Loggable-3A-3AActivity+is+formatted+for+the+view">example of how a <code>Loggable::Activity</code> is formatted for the view<span><a href="#label-example+of+how+a+Loggable-3A-3AActivity+is+formatted+for+the+view">&para;</a> <a href="#top">&uarr;</a></span></h3>

<pre>activity = Loggable::Activity.lastest.last
activity.attrs ==&gt;

payloads: [
  primary: {
    name: &quot;User&quot;,
    changes: {
      attrs: {
        first_name: {
          from: &quot;Bob&quot;,
          to: &quot;Rob&quot;
        }
      }
    }
  }
  relations: [
    name: &quot;Demo::Address
    changes: {
      street: {
        from: &quot;5th Avenue&quot;,
        to: &quot;Broadway&quot;
      } 
    }
  ]
]</pre>

</main>



<footer id="validator-badges" role="contentinfo">
  <p><a href="https://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="https://ruby.github.io/rdoc/">RDoc</a> 6.6.2.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

